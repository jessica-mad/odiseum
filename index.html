<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odiseum V2.0 - Refactorizado</title>
    
    <!-- CSS Files (in order) -->
    <link rel="stylesheet" href="styles/1-variables.css">
    <link rel="stylesheet" href="styles/2-base.css">
    <link rel="stylesheet" href="styles/3-layout.css">
    <link rel="stylesheet" href="styles/4-components.css">
    <link rel="stylesheet" href="styles/6-theme-terminal.css">
    <link rel="stylesheet" href="styles/7-components-terminal.css">
    <link rel="stylesheet" href="styles/8-ship-map.css">
    <link rel="stylesheet" href="styles/9-mobile-panels.css">
    <link rel="stylesheet" href="styles/10-configurator.css">
</head>
<body>
    <!-- Pantalla de Inicio / Login -->
    <div id="initial-screen" class="initial-screen">
        <div class="login-box">
            <h1>ODISEUM V2.0</h1>
            <p>Sistema de Inteligencia Artificial</p>
            <div class="login-form">
                <label for="player-name-input">Identificaci√≥n de IA:</label>
                <input type="text" id="player-name-input" placeholder="Ingrese su nombre">

                <div class="seed-separator">
                    <span class="separator-line"></span>
                    <span class="separator-text">MISI√ìN EXISTENTE (OPCIONAL)</span>
                    <span class="separator-line"></span>
                </div>

                <label for="player-seed-input">C√≥digo de Misi√≥n (SEED):</label>
                <input type="text" id="player-seed-input" placeholder="KEPLER-XXXXXX (opcional)">
                <p class="seed-hint">Si tienes un c√≥digo de misi√≥n anterior, ingr√©salo aqu√≠ para repetir la configuraci√≥n.</p>

                <button onclick="namePlayer()">Comenzar</button>
            </div>
        </div>
    </div>

    <!-- Introducci√≥n Proyecto G√©nesis -->
    <div id="intro-overlay" class="intro-overlay" style="display: none;">
        <div class="intro-window">
            <div class="logbook-intro">
                <h2>PROYECTO G√âNESIS</h2>
                <pre id="intro-text-content"></pre>
                <button class="intro-mission-btn" onclick="startMissionFromIntro()">CONFIGURAR MISI√ìN</button>
            </div>
        </div>
    </div>

    <!-- Configurador de Misi√≥n -->
    <div id="mission-configurator" class="mission-configurator" style="display: none;">
        <div class="configurator-window">
            <!-- Header -->
            <div class="configurator-header">
                <h2 class="configurator-title">CONFIGURACI√ìN DE MISI√ìN</h2>
                <div class="configurator-step-indicator" id="config-step-indicator">PASO 1/3</div>
            </div>

            <!-- PASO 1: TRIPULACI√ìN -->
            <div id="config-step-1" class="config-step">
                <div class="config-step-header">
                    <h3>üë• SELECCI√ìN DE TRIPULACI√ìN</h3>
                    <p class="config-step-description">Elige a los especialistas que viajar√°n despiertos. Cada uno consume puntos de presupuesto.</p>
                </div>

                <div class="config-budget-bar">
                    <div class="budget-label">PRESUPUESTO DE TRIPULACI√ìN</div>
                    <div class="budget-display">
                        <span id="crew-budget-used">0</span> / <span id="crew-budget-total">25</span> PUNTOS
                    </div>
                    <div class="budget-meter">
                        <div id="crew-budget-fill" class="budget-fill" style="width: 0%;"></div>
                    </div>
                </div>

                <div class="config-crew-container" id="config-crew-container">
                    <!-- Se llenar√° con JavaScript en el siguiente sprint -->
                    <p class="placeholder-text">[ Selecci√≥n de personajes - Pr√≥ximo sprint ]</p>
                </div>

                <div class="config-step-nav">
                    <button class="config-btn config-btn-next" onclick="nextConfigStep(1)">SIGUIENTE: RECURSOS ‚Üí</button>
                </div>
            </div>

            <!-- PASO 2: RECURSOS -->
            <div id="config-step-2" class="config-step" style="display: none;">
                <div class="config-step-header">
                    <h3>üì¶ DISTRIBUCI√ìN DE RECURSOS</h3>
                    <p class="config-step-description">Configura la carga inicial de la nave. El peso total no puede exceder 3000 kg.</p>
                </div>

                <div class="config-budget-bar">
                    <div class="budget-label">PESO DE CARGA</div>
                    <div class="budget-display">
                        <span id="cargo-weight-used">0</span> / <span id="cargo-weight-total">3000</span> KG
                    </div>
                    <div class="budget-meter">
                        <div id="cargo-weight-fill" class="budget-fill" style="width: 0%;"></div>
                    </div>
                </div>

                <div class="config-presets">
                    <div class="presets-label">PRESETS R√ÅPIDOS:</div>
                    <div class="presets-buttons">
                        <button class="preset-btn">‚öñÔ∏è Balanceado</button>
                        <button class="preset-btn">üõ°Ô∏è Supervivencia</button>
                        <button class="preset-btn">‚ö° Velocista</button>
                    </div>
                </div>

                <div class="config-resources-container" id="config-resources-container">
                    <!-- Se llenar√° con sliders en el siguiente sprint -->
                    <p class="placeholder-text">[ Sliders de recursos - Pr√≥ximo sprint ]</p>
                </div>

                <div class="config-step-nav">
                    <button class="config-btn config-btn-back" onclick="prevConfigStep(2)">‚Üê ATR√ÅS</button>
                    <button class="config-btn config-btn-next" onclick="nextConfigStep(2)">SIGUIENTE: CONFIRMAR ‚Üí</button>
                </div>
            </div>

            <!-- PASO 3: CONFIRMACI√ìN -->
            <div id="config-step-3" class="config-step" style="display: none;">
                <div class="config-step-header">
                    <h3>‚úÖ CONFIRMACI√ìN DE MISI√ìN</h3>
                    <p class="config-step-description">Revisa tu configuraci√≥n antes de partir. Esta decisi√≥n es irreversible.</p>
                </div>

                <div class="config-summary">
                    <div class="summary-section">
                        <h4>üë• TRIPULACI√ìN SELECCIONADA</h4>
                        <div id="summary-crew" class="summary-content">
                            <p class="placeholder-text">[ Resumen de tripulaci√≥n - Pr√≥ximo sprint ]</p>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>üì¶ RECURSOS ASIGNADOS</h4>
                        <div id="summary-resources" class="summary-content">
                            <p class="placeholder-text">[ Resumen de recursos - Pr√≥ximo sprint ]</p>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>üó∫Ô∏è RUTA DE VIAJE</h4>
                        <div id="summary-route" class="summary-content">
                            <p>Destino: Kepler-442b (Nueva Tierra)</p>
                            <p>Distancia: 3,000 UA</p>
                            <p>Tiempo estimado: 50 a√±os</p>
                        </div>
                    </div>

                    <div class="summary-section seed-section">
                        <h4>üé≤ SEED DE MISI√ìN</h4>
                        <div class="seed-display">
                            <input type="text" id="mission-seed" class="seed-input" value="GENESIS-2024-XXXX" readonly>
                            <button class="seed-copy-btn" title="Copiar seed">üìã</button>
                        </div>
                        <p class="seed-note">Guarda este c√≥digo para repetir esta configuraci√≥n exacta.</p>
                    </div>
                </div>

                <div class="config-step-nav">
                    <button class="config-btn config-btn-back" onclick="prevConfigStep(3)">‚Üê ATR√ÅS</button>
                    <button class="config-btn config-btn-start" onclick="missionConfigurator.confirmAndStart()">üöÄ COMENZAR MISI√ìN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Escritorio Principal -->
    <div id="desktop" class="desktop" style="display: none;">
        <!-- Barra de T√≠tulo Principal - Desktop -->
        <div class="title-bar-main desktop-only">
            <div class="top-bar-section">
                <span class="title-text">Odiseum V2.0</span>
            </div>
            <div class="top-bar-section center">
                <span class="mission-title">PROYECTO G√âNESIS - NUEVA TIERRA</span>
            </div>
            <div class="top-bar-section">
                <span class="player-name-display">IA: <span id="playerName">---</span></span>
            </div>
        </div>

        <!-- === VERSI√ìN M√ìVIL === -->
        <!-- Top Bar 1 - Mobile -->
        <div class="mobile-top-bar-1 mobile-only" style="display: none;">
            <span class="mobile-game-title">ODISEUM V2.0</span>
            <span class="mobile-player-name">IA: <span id="playerName-mobile">---</span></span>
        </div>

        <!-- Top Bar 2 - Mobile -->
        <div class="mobile-top-bar-2 mobile-only" style="display: none;">
            <span class="mobile-mission-title">PROYECTO G√âNESIS</span>
            <span class="mobile-separator">|</span>
            <span class="mobile-year-display" id="mobile-year-display">A√ëO 0</span>
        </div>

        <!-- Terminal/Content Area - Mobile -->
        <div class="mobile-content-area mobile-only" id="mobile-content-area" style="display: none;">
            <div class="mobile-terminal" id="mobile-terminal">
                <div class="terminal-line">&gt; Sistema iniciado...</div>
                <div class="terminal-line">&gt; Esperando instrucciones...</div>
            </div>
        </div>

        <!-- Barra de Recursos Permanente - Desktop -->
        <div class="resource-strip desktop-only" id="resource-strip">
            <div class="resource-chip" id="resource-chip-energy">
                <span class="resource-label">Energ√≠a:</span>
                <span class="resource-value" id="resource-strip-energy">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-food">
                <span class="resource-label">Alimentos:</span>
                <span class="resource-value" id="resource-strip-food">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-water">
                <span class="resource-label">Agua:</span>
                <span class="resource-value" id="resource-strip-water">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-oxygen">
                <span class="resource-label">Ox√≠geno:</span>
                <span class="resource-value" id="resource-strip-oxygen">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-medicine">
                <span class="resource-label">Medicinas:</span>
                <span class="resource-value" id="resource-strip-medicine">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-data">
                <span class="resource-label">Datos:</span>
                <span class="resource-value" id="resource-strip-data">0/0</span>
            </div>
            <div class="resource-chip" id="resource-chip-fuel">
                <span class="resource-label">Combustible:</span>
                <span class="resource-value" id="resource-strip-fuel">0/0</span>
            </div>
        </div>

        <!-- Consola de Navegaci√≥n (Inferior) - Desktop Only -->
        <div class="voyage-visualizer desktop-only" id="voyage-visualizer">
            <div class="nav-controls-section">
                <div class="nav-control-group">
                    <label class="nav-label">VELOCIDAD NAVE</label>
                    <div class="nav-speed-display" id="nav-speed-display">100%</div>
                    <input type="range" id="nav-speed-slider" min="0" max="100" value="100" class="nav-slider">
                </div>
                <div class="nav-control-group">
                    <label class="nav-label">TIEMPO TRAMO</label>
                    <div class="tranche-timer" id="tranche-timer">00:00</div>
                </div>
                <div class="nav-control-group">
                    <label class="nav-label">A√ëOS VIAJE</label>
                    <div class="calendar" id="calendar">A√ëO 0</div>
                </div>
                <div class="nav-control-buttons">
                    <button id="start-button" class="nav-btn primary" onclick="startGame()">INICIAR TRAMO</button>
                    <button id="pause-button" class="nav-btn" onclick="pauseGame()" style="display: none;">PAUSAR</button>
                    <button id="resume-button" class="nav-btn" onclick="resumeGame()" style="display: none;">REANUDAR</button>
                </div>
            </div>

            <div class="voyage-panels">
                <div class="voyage-endpoint">
                    <div class="planet-icon old-earth">üåç</div>
                    <span class="planet-label">TIERRA VIEJA</span>
                </div>
                <div class="voyage-track">
                    <div class="voyage-track-line">
                        <div class="voyage-progress-fill" id="voyage-progress-fill"></div>
                    </div>
                    <div class="voyage-nodes" id="voyage-node-container"></div>
                </div>
                <div class="voyage-endpoint">
                    <div class="planet-icon new-earth">ü™ê</div>
                    <span class="planet-label">NUEVA TIERRA</span>
                </div>
            </div>

            <div class="voyage-readouts">
                <div class="voyage-speed">VEL: <span id="voyage-speed-value">0%</span></div>
                <div class="voyage-distance">DIST: <span id="voyage-distance-current">0</span> / <span id="voyage-distance-total">0</span> UA</div>
                <div class="voyage-forecast inactive" id="voyage-forecast">PROYECCI√ìN: ACTIVAR NAVEGANTE</div>
            </div>
        </div>

        <!-- Vi√±etas del Acorde√≥n - Mobile -->
        <div class="mobile-tabs mobile-only" id="mobile-tabs" style="display: none;">
            <div class="mobile-tab" data-panel="resources" onclick="toggleMobileAccordion('resources')">
                <span class="tab-icon">üì¶</span>
            </div>
            <div class="mobile-tab" data-panel="crew" onclick="toggleMobileAccordion('crew')">
                <span class="tab-icon">üë•</span>
            </div>
            <div class="mobile-tab" data-panel="map" onclick="toggleMobileAccordion('map')">
                <span class="tab-icon">üó∫Ô∏è</span>
            </div>
            <div class="mobile-tab" data-panel="speed" onclick="toggleMobileAccordion('speed')">
                <span class="tab-icon">‚ö°</span>
            </div>
        </div>

        <!-- Paneles del Acorde√≥n - Mobile -->
        <!-- Panel Recursos -->
        <div class="mobile-accordion-panel" id="mobile-panel-resources">
            <div class="mobile-panel-header" onclick="closeMobileAccordion()">
                <span class="panel-header-icon">üì¶</span>
                <span class="panel-header-title">GESTI√ìN DE RECURSOS</span>
            </div>
            <div class="mobile-panel-body">
                <div id="resources-mobile-container">
                    <!-- Se llena con JS -->
                </div>
            </div>
        </div>

        <!-- Panel Tripulaci√≥n -->
        <div class="mobile-accordion-panel" id="mobile-panel-crew">
            <div class="mobile-panel-header" onclick="closeMobileAccordion()">
                <span class="panel-header-icon">üë•</span>
                <span class="panel-header-title">TRIPULACI√ìN</span>
            </div>
            <div class="mobile-panel-body">
                <div class="crew-columns-mobile">
                    <div class="crew-column-mobile">
                        <div class="crew-column-header-mobile">DESPIERTOS</div>
                        <div class="crew-column-content-mobile" id="mobile-crew-awake">
                            <!-- Tripulantes despiertos -->
                        </div>
                    </div>
                    <div class="crew-column-mobile">
                        <div class="crew-column-header-mobile">ENCAPSULADOS</div>
                        <div class="crew-column-content-mobile" id="mobile-crew-asleep">
                            <!-- Tripulantes encapsulados -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Panel Mapa -->
        <div class="mobile-accordion-panel" id="mobile-panel-map">
            <div class="mobile-panel-header" onclick="closeMobileAccordion()">
                <span class="panel-header-icon">üó∫Ô∏è</span>
                <span class="panel-header-title">MAPA DE LA NAVE</span>
            </div>
            <div class="mobile-panel-body">
                <div id="map-mobile-container">
                    <!-- El mapa se mostrar√° aqu√≠ -->
                </div>
            </div>
        </div>

        <!-- Panel Velocidad -->
        <div class="mobile-accordion-panel" id="mobile-panel-speed">
            <div class="mobile-panel-header" onclick="closeMobileAccordion()">
                <span class="panel-header-icon">‚ö°</span>
                <span class="panel-header-title">CONTROL DE VELOCIDAD</span>
            </div>
            <div class="mobile-panel-body">
                <div class="speed-control-container">
                    <div class="nav-control-group">
                        <label class="nav-label">VELOCIDAD NAVE</label>
                        <div class="nav-speed-display" id="nav-speed-display-mobile">100%</div>
                        <input type="range" id="nav-speed-slider-mobile" min="0" max="100" value="100" class="nav-slider">
                    </div>
                </div>
            </div>
        </div>

        <!-- Barra Inferior Sticky para M√≥vil -->
        <div class="mobile-bottom-bar mobile-only" id="mobile-bottom-bar" style="display: none;">
            <div class="mobile-voyage-info">
                <div class="mobile-voyage-row">
                    <span class="mobile-voyage-label">Tiempo de tramo:</span>
                    <span class="mobile-voyage-value" id="mobile-tranche-timer">00:00</span>
                    <span class="mobile-voyage-separator">-</span>
                    <span class="mobile-voyage-label">A√±os de viaje:</span>
                    <span class="mobile-voyage-value" id="mobile-calendar">A√ëO 0</span>
                </div>
                <div class="mobile-voyage-progress">
                    <div class="mobile-voyage-endpoint">üåç</div>
                    <div class="mobile-voyage-track">
                        <div class="mobile-voyage-line">
                            <div class="mobile-voyage-fill" id="mobile-voyage-fill"></div>
                        </div>
                        <div class="mobile-voyage-label-text">VIAJE</div>
                    </div>
                    <div class="mobile-voyage-endpoint">ü™ê</div>
                </div>
                <div class="mobile-voyage-row">
                    <span class="mobile-voyage-label">Tramo:</span>
                    <span class="mobile-voyage-value" id="mobile-tranche-count">0/10</span>
                </div>
            </div>
            <div class="mobile-start-button-container">
                <button id="mobile-start-btn" class="mobile-start-btn" onclick="startGame()">INICIAR TRAMO</button>
                <button id="mobile-pause-btn" class="mobile-start-btn" onclick="pauseGame()" style="display: none;">PAUSAR</button>
                <button id="mobile-resume-btn" class="mobile-start-btn" onclick="resumeGame()" style="display: none;">REANUDAR</button>
            </div>
        </div>

        <!-- √Årea Principal del Escritorio - Desktop Only -->
        <div class="desktop-main-area desktop-only">
            <!-- Iconos del Escritorio -->
            <div class="desktop-icons">
                <div class="desktop-icon" id="icon-logbook" ondblclick="openLogbookPopup()">
                    <div class="icon-image">üìñ</div>
                    <div class="icon-label">Bit√°cora</div>
                </div>
            </div>

            <!-- Terminal de Notificaciones -->
            <div class="terminal-notification-area">
                <div class="terminal-header">
                    <span class="terminal-prompt">&gt; CONSOLA DE SISTEMA</span>
                    <span class="terminal-time" id="terminal-time">00:00:00</span>
                </div>
                <div class="terminal-content" id="terminal-notifications">
                    <div class="terminal-line">&gt; Sistema iniciado...</div>
                    <div class="terminal-line">&gt; Esperando instrucciones...</div>
                </div>
            </div>
        </div>

        <!-- ============================================
             PANELES DESPLEGABLES - PAPERS PLEASE STYLE
             ============================================ -->

        <!-- PANEL IZQUIERDO: MAPA -->
        <div id="panel-map" class="panel-left desktop-only">
            <div class="panel-header">
                <h3>üó∫Ô∏è MAPA DE LA NAVE</h3>
            </div>
            <div class="panel-content">
                <div class="ship-map-container" id="ship-map-container">
                    <!-- Se genera din√°micamente con JS -->
                </div>
            </div>
        </div>

        <!-- TAB IZQUIERDO (MAPA) -->
        <div id="panel-tab-map" class="panel-tab-vertical panel-tab-left desktop-only">
            MAPA
        </div>

        <!-- PANEL DERECHO: TRIPULACI√ìN -->
        <div id="panel-crew" class="panel-right desktop-only">
            <div class="panel-header">
                <h3>üöÄ TRIPULACI√ìN</h3>
            </div>
            <div class="panel-sorting">
                <label for="crew-sort-select">Ordenar por:</label>
                <select id="crew-sort-select" onchange="onSortChange()">
                    <!-- Se genera din√°micamente con JS -->
                </select>
            </div>
            <div class="panel-content panel-crew-content">
                <div class="crew-columns">
                    <div class="crew-column">
                        <div class="crew-column-header">DESPIERTOS</div>
                        <div class="crew-column-content" id="panel-crew-awake">
                            <!-- Tripulantes despiertos -->
                        </div>
                    </div>
                    <div class="crew-column">
                        <div class="crew-column-header">ENCAPSULADOS</div>
                        <div class="crew-column-content" id="panel-crew-asleep">
                            <!-- Tripulantes en c√°psulas -->
                        </div>
                    </div>
                </div>
                <div class="crew-quick-controls">
                    <button class="crew-control-btn sleep-all" onclick="sleepAllCrew()" title="Encapsular a todos">
                        üí§
                    </button>
                    <button class="crew-control-btn wake-all" onclick="wakeAllCrew()" title="Despertar a todos">
                        ‚ö°
                    </button>
                </div>
            </div>
        </div>

        <!-- TAB DERECHO (TRIPULACI√ìN) -->
        <div id="panel-tab-crew" class="panel-tab-vertical panel-tab-right desktop-only">
            TRIPULACI√ìN
        </div>

        <!-- PANEL INFERIOR: CONTROL (usa el voyage-visualizer existente) -->
        <div id="panel-control" class="panel-bottom desktop-only">
            <!-- El contenido se mover√° aqu√≠ desde voyage-visualizer -->
        </div>

        <!-- TAB HORIZONTAL (CONTROL) -->
        <div id="panel-tab-control" class="panel-tab-horizontal desktop-only">
            CONTROL
        </div>

        <!-- Sidebars antiguos (ocultos, mantener compatibilidad) -->
        <div class="ship-map-sidebar desktop-only" id="ship-map-sidebar" style="display: none;">
            <div class="sidebar-header">
                <h3>üó∫Ô∏è MAPA DE LA NAVE</h3>
                <button class="sidebar-close-btn" onclick="shipMapSystem.toggleVisibility()">√ó</button>
            </div>
            <div class="sidebar-content">
                <!-- Placeholder -->
            </div>
        </div>

        <div class="crew-sidebar desktop-only" id="crew-sidebar" style="display: none;">
            <div class="sidebar-header">
                <h3>üöÄ TRIPULACI√ìN</h3>
            </div>
            <div class="sidebar-sorting">
                <label for="crew-sort-select-old">Ordenar por:</label>
                <select id="crew-sort-select-old" onchange="onSortChange()">
                    <!-- Se genera din√°micamente con JS -->
                </select>
            </div>
            <div class="sidebar-content" id="crew-cards-container">
                <!-- Se genera din√°micamente con JS -->
            </div>
        </div>

        <!-- Popup: Gesti√≥n de Recursos -->
        <div id="resources-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-resources">
                <span class="title">Gesti√≥n de Recursos</span>
                <button class="close-btn" onclick="closeResourcesPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Reservas de la Nave</h3>
                <div class="resource-item">
                    <label>Energ√≠a:</label>
                    <meter id="energy-meter" min="0" max="1000" value="1000"></meter>
                    <span id="energy-amount">1000/1000</span>
                </div>
                <div class="resource-item">
                    <label>Alimentos:</label>
                    <meter id="food-meter" min="0" max="500" value="500"></meter>
                    <span id="food-amount">500/500</span>
                </div>
                <div class="resource-item">
                    <label>Agua:</label>
                    <meter id="water-meter" min="0" max="300" value="300"></meter>
                    <span id="water-amount">300/300</span>
                </div>
                <div class="resource-item">
                    <label>Ox√≠geno:</label>
                    <meter id="oxygen-meter" min="0" max="400" value="400"></meter>
                    <span id="oxygen-amount">400/400</span>
                </div>
                <div class="resource-item">
                    <label>Medicinas:</label>
                    <meter id="medicine-meter" min="0" max="200" value="200"></meter>
                    <span id="medicine-amount">200/200</span>
                </div>
                <div class="resource-item">
                    <label>Datos/Entret.:</label>
                    <meter id="data-meter" min="0" max="150" value="150"></meter>
                    <span id="data-amount">150/150</span>
                </div>
            </div>
        </div>

        <!-- Popup: Gesti√≥n del Viaje -->
        <div id="trip-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-trip">
                <span class="title">Gesti√≥n del Viaje</span>
                <button class="close-btn" onclick="closeTripPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Progreso del Viaje</h3>
                <div class="trip-info">
                    <label>Destino: Nueva Tierra (Kepler-442b)</label>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="trip-progress-bar"></div>
                    </div>
                    <p>Distancia: <span id="distance-traveled">0</span> / <span id="total-distance">3000</span> UA</p>
                </div>
                <div class="trip-controls">
                    <h4>Control de Velocidad</h4>
                    <label>Velocidad: <span id="speed-value">65</span>%</label>
                    <input type="range" id="speed-control" min="50" max="100" value="65" oninput="updateSpeedDisplay()">
                    <p class="speed-note">‚ö†Ô∏è Mayor velocidad = Mayor consumo de combustible</p>
                </div>
                <div class="fuel-info">
                    <label>Combustible:</label>
                    <meter id="fuel-meter" min="0" max="1000" value="1000"></meter>
                    <span id="fuel-amount">1000/1000</span>
                </div>
            </div>
        </div>

        <!-- Popup: Lista de Tripulaci√≥n -->
        <div id="crews-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crews">
                <span class="title">Gesti√≥n de Tripulaci√≥n</span>
                <button class="close-btn" onclick="closeCrewsPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Tripulaci√≥n de la Odiseum</h3>
                <table class="crew-table">
                    <thead>
                        <tr>
                            <th>Estado</th>
                            <th>Nombre</th>
                            <th>Posici√≥n</th>
                            <th>Edad</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="crew-list">
                        <!-- Se genera din√°micamente con JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Popup: Gesti√≥n Individual de Tripulante -->
        <div id="crew-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crew">
                <span class="title">Gesti√≥n de Tripulante</span>
                <button class="close-btn" onclick="closeCrewManagementPopup(event)">√ó</button>
            </div>
            <div class="window-content">
                <div class="crew-header">
                    <img id="crew-img" src="" alt="Tripulante" class="crew-avatar">
                    <div class="crew-info">
                        <h3 id="crew-name">---</h3>
                        <p>Edad: <span id="crew-age">--</span> a√±os</p>
                        <p>Edad Biol√≥gica: <span id="crew-bio-age">--</span> a√±os</p>
                        <p>Posici√≥n: <span id="crew-position">---</span></p>
                        <p>Estado: <span id="crew-state">---</span></p>
                        <p>Actividad: <span id="crew-activity">---</span></p>
                        <p>√Ånimo: <span id="crew-mood">---</span></p>
                        <p class="crew-benefit-line">Beneficio activo: <span id="crew-benefit-readout">Beneficio inactivo (encapsulado).</span></p>
                    </div>
                </div>

                <!-- Sistema de Tabs -->
                <div class="crew-tabs">
                    <button class="crew-tab-btn active" onclick="switchCrewTab('needs')">Necesidades Vitales</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('personal')">Informaci√≥n Personal</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('report')">Reporte</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('story')">Historia IA</button>
                </div>

                <!-- Tab: Necesidades Vitales -->
                <div id="crew-tab-needs" class="crew-tab-content active">
                    <div class="crew-needs">
                        <h4>Necesidades Vitales</h4>
                        <table class="needs-table" id="needs-list">
                            <tr>
                                <td>üçï Alimentaci√≥n</td>
                                <td><span id="food-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageFoodNeed()">Alimentar</button></td>
                            </tr>
                            <tr>
                                <td>‚ù§Ô∏è Salud</td>
                                <td><span id="health-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageHealthNeed()">Curar</button></td>
                            </tr>
                            <tr>
                                <td>üöΩ Higiene</td>
                                <td><span id="waste-need-amount">0</span>%</td>
                                <td><button class="manage-btn" onclick="manageWasteNeed()">Limpiar</button></td>
                            </tr>
                            <tr>
                                <td>üéÆ Entretenimiento</td>
                                <td><span id="entertainment-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageEntertainmentNeed()">Entretener</button></td>
                            </tr>
                            <tr>
                                <td>üò¥ Descanso</td>
                                <td><span id="rest-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageRestNeed()">Descansar</button></td>
                            </tr>
                        </table>
                    </div>
                    <div class="crew-actions">
                        <button id="wake-sleep-btn" onclick="updateWakeSleepFromPopup()">Cambiar Estado</button>
                    </div>
                </div>

                <!-- Tab: Informaci√≥n Personal -->
                <div id="crew-tab-personal" class="crew-tab-content">
                    <div class="crew-personal-info" id="crew-personal-info">
                        <!-- Se llena din√°micamente con JS -->
                    </div>
                </div>

                <!-- Tab: Reporte Personal -->
                <div id="crew-tab-report" class="crew-tab-content">
                    <div class="crew-personal-log">
                        <h4>üìù Reporte Personal</h4>
                        <div id="crew-personal-log-content" class="personal-log-content">
                            <!-- Se llenar√° con JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Historia IA -->
                <div id="crew-tab-story" class="crew-tab-content">
                    <div class="crew-ai-story">
                        <h4>üìñ Historia del Personaje</h4>
                        <div id="crew-ai-story-content" class="ai-story-content">
                            <p style="color: #999; font-style: italic;">Cargando historia...</p>
                        </div>
                        <button class="action-btn" onclick="generateCrewStory()">Generar Historia con IA</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup: Bit√°cora del Comandante -->
        <div id="logbook-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-logbook">
                <span class="title">üìñ Bit√°cora de Odiseum</span>
                <button class="close-btn" onclick="closeLogbookPopup(event)">√ó</button>
            </div>
            <div class="window-content">
                <div class="logbook-header">
                    <h3>Registro de Misi√≥n</h3>
                    <p class="mission-objective">Objetivo: Transportar cargamento vital a Nueva Tierra</p>
                </div>
                <div class="logbook-entries" id="logbook-entries">
                    <!-- Se genera din√°micamente con JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files (in order) -->
    <script src="scripts/icon-loader.js"></script>
    <script src="scripts/8-icon-replacer.js"></script>
    <script src="scripts/9-navigation-terminal.js"></script>
    <script src="scripts/0-config.js"></script>
    <script src="scripts/1-models.js"></script>
    <script src="scripts/2-systems.js"></script>
    <script src="scripts/panel-manager.js"></script>
    <script src="scripts/3-ui-managers.js"></script>
    <script src="scripts/4-crew-data.js"></script>
    <script src="scripts/5-messages-data.js"></script>
    <script src="scripts/7-events-data.js"></script>
    <script src="scripts/10-ship-map.js"></script>
    <script src="scripts/6-main.js"></script>
    <script src="scripts/11-configurator.js"></script>
</body>
</html>
