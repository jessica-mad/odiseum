<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odiseum V2.0 - Refactorizado</title>
    
    <!-- CSS Files (in order) -->
    <link rel="stylesheet" href="styles/1-variables.css">
    <link rel="stylesheet" href="styles/2-base.css">
    <link rel="stylesheet" href="styles/3-layout.css">
    <link rel="stylesheet" href="styles/4-components.css">
    <link rel="stylesheet" href="styles/6-theme-terminal.css">
    <link rel="stylesheet" href="styles/7-components-terminal.css">
</head>
<body>
    <!-- Pantalla de Inicio / Login -->
    <div id="initial-screen" class="initial-screen">
        <div class="login-box">
            <h1>ODISEUM V2.0</h1>
            <p>Sistema de Inteligencia Artificial</p>
            <div class="login-form">
                <label for="player-name-input">Identificaci√≥n de IA:</label>
                <input type="text" id="player-name-input" placeholder="Ingrese su nombre">
                <button onclick="namePlayer()">Ese es mi nombre</button>
            </div>
        </div>
    </div>

    <!-- Introducci√≥n Proyecto G√©nesis -->
    <div id="intro-overlay" class="intro-overlay" style="display: none;">
        <div class="intro-window">
            <div class="logbook-intro">
                <h2>PROYECTO G√âNESIS</h2>
                <pre id="intro-text-content"></pre>
                <button class="intro-mission-btn" onclick="startMissionFromIntro()">INICIAR MISI√ìN</button>
            </div>
        </div>
    </div>

    <!-- Escritorio Principal -->
    <div id="desktop" class="desktop" style="display: none;">
        <!-- Barra de T√≠tulo Principal -->
        <div class="title-bar-main">
            <span class="title-text">Odiseum V2.0</span>
            <span class="player-name-display">IA: <span id="playerName">---</span></span>
        </div>

        <!-- Barra de Detalles / Men√∫ -->
        <div class="details-bar">
            <div class="menu-section">
                <button class="menu-btn">Configuraci√≥n</button>
                <button class="menu-btn">Instrucciones</button>
            </div>
            <div class="controls-section">
                <button id="start-button" class="control-btn" onclick="startGame()">Comenzar</button>
                <button id="pause-button" class="control-btn" onclick="pauseGame()" style="display: none;">Pausar</button>
                <button id="resume-button" class="control-btn" onclick="resumeGame()" style="display: none;">Reanudar</button>
                <div class="voyage-status" id="voyage-status" style="display: none;"></div>
                <div class="tranche-timer" id="tranche-timer">01:00</div>
                <div class="calendar" id="calendar">A√±o 0</div>
            </div>
        </div>

        <!-- Barra de Recursos Permanente -->
        <div class="resource-strip" id="resource-strip">
            <div class="resource-chip">
                <span class="resource-icon">‚ö°</span>
                <span class="resource-label">Energ√≠a</span>
                <span class="resource-value" id="resource-strip-energy">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">üç≤</span>
                <span class="resource-label">Alimentos</span>
                <span class="resource-value" id="resource-strip-food">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">üíß</span>
                <span class="resource-label">Agua</span>
                <span class="resource-value" id="resource-strip-water">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">üå¨Ô∏è</span>
                <span class="resource-label">Ox√≠geno</span>
                <span class="resource-value" id="resource-strip-oxygen">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">üíä</span>
                <span class="resource-label">Medicinas</span>
                <span class="resource-value" id="resource-strip-medicine">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">üíæ</span>
                <span class="resource-label">Datos</span>
                <span class="resource-value" id="resource-strip-data">0/0</span>
            </div>
            <div class="resource-chip">
                <span class="resource-icon">‚õΩ</span>
                <span class="resource-label">Combustible</span>
                <span class="resource-value" id="resource-strip-fuel">0/0</span>
            </div>
        </div>

        <div class="voyage-visualizer" id="voyage-visualizer">
            <div class="voyage-panels">
                <div class="voyage-endpoint">
                    <div class="planet-icon old-earth">üåç</div>
                    <span class="planet-label">Tierra Vieja</span>
                </div>
                <div class="voyage-track">
                    <div class="voyage-track-line">
                        <div class="voyage-progress-fill" id="voyage-progress-fill"></div>
                    </div>
                    <div class="voyage-nodes" id="voyage-node-container"></div>
                </div>
                <div class="voyage-endpoint">
                    <div class="planet-icon new-earth">ü™ê</div>
                    <span class="planet-label">Nueva Tierra</span>
                </div>
            </div>
            <div class="voyage-readouts">
                <div class="voyage-speed">Velocidad actual: <span id="voyage-speed-value">0%</span></div>
                <div class="voyage-distance">Distancia: <span id="voyage-distance-current">0</span> / <span id="voyage-distance-total">0</span> UA</div>
                <div class="voyage-forecast inactive" id="voyage-forecast">Activa a Lt. Johnson para obtener proyecci√≥n de tramos.</div>
            </div>
        </div>

        <!-- √Årea Principal del Escritorio -->
        <div class="desktop-main-area">
            <!-- Iconos del Escritorio -->
            <div class="desktop-icons">
                <div class="desktop-icon" id="icon-resources-management" ondblclick="openResourcesPopup()">
                    <div class="icon-image">üì¶</div>
                    <div class="icon-label">Recursos</div>
                </div>
                <div class="desktop-icon" id="icon-crews-management" ondblclick="openCrewsPopup()">
                    <div class="icon-image">üë•</div>
                    <div class="icon-label">Tripulaci√≥n</div>
                </div>
                <div class="desktop-icon" id="icon-trip-management" ondblclick="openTripPopup()">
                    <div class="icon-image">üöÄ</div>
                    <div class="icon-label">Viaje</div>
                </div>
                <div class="desktop-icon" id="icon-logbook" ondblclick="openLogbookPopup()">
                    <div class="icon-image">üìñ</div>
                    <div class="icon-label">Bit√°cora</div>
                </div>
            </div>

            <!-- Panel de Notificaciones -->
            <div id="notifications" class="notifications-panel"></div>
        </div>

        <!-- Panel Lateral de Tripulaci√≥n (SIEMPRE VISIBLE) -->
        <div class="crew-sidebar" id="crew-sidebar">
            <div class="sidebar-header">
                <h3>üöÄ TRIPULACI√ìN</h3>
            </div>
            <div class="sidebar-sorting">
                <label for="crew-sort-select">Ordenar por:</label>
                <select id="crew-sort-select" onchange="onSortChange()">
                    <!-- Se genera din√°micamente con JS -->
                </select>
            </div>
            <div class="sidebar-content" id="crew-cards-container">
                <!-- Se genera din√°micamente con JS -->
            </div>
        </div>

        <!-- Popup: Gesti√≥n de Recursos -->
        <div id="resources-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-resources">
                <span class="title">Gesti√≥n de Recursos</span>
                <button class="close-btn" onclick="closeResourcesPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Reservas de la Nave</h3>
                <div class="resource-item">
                    <label>Energ√≠a:</label>
                    <meter id="energy-meter" min="0" max="1000" value="1000"></meter>
                    <span id="energy-amount">1000/1000</span>
                </div>
                <div class="resource-item">
                    <label>Alimentos:</label>
                    <meter id="food-meter" min="0" max="500" value="500"></meter>
                    <span id="food-amount">500/500</span>
                </div>
                <div class="resource-item">
                    <label>Agua:</label>
                    <meter id="water-meter" min="0" max="300" value="300"></meter>
                    <span id="water-amount">300/300</span>
                </div>
                <div class="resource-item">
                    <label>Ox√≠geno:</label>
                    <meter id="oxygen-meter" min="0" max="400" value="400"></meter>
                    <span id="oxygen-amount">400/400</span>
                </div>
                <div class="resource-item">
                    <label>Medicinas:</label>
                    <meter id="medicine-meter" min="0" max="200" value="200"></meter>
                    <span id="medicine-amount">200/200</span>
                </div>
                <div class="resource-item">
                    <label>Datos/Entret.:</label>
                    <meter id="data-meter" min="0" max="150" value="150"></meter>
                    <span id="data-amount">150/150</span>
                </div>
            </div>
        </div>

        <!-- Popup: Gesti√≥n del Viaje -->
        <div id="trip-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-trip">
                <span class="title">Gesti√≥n del Viaje</span>
                <button class="close-btn" onclick="closeTripPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Progreso del Viaje</h3>
                <div class="trip-info">
                    <label>Destino: Nueva Tierra (Kepler-442b)</label>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="trip-progress-bar"></div>
                    </div>
                    <p>Distancia: <span id="distance-traveled">0</span> / <span id="total-distance">3000</span> UA</p>
                </div>
                <div class="trip-controls">
                    <h4>Control de Velocidad</h4>
                    <label>Velocidad: <span id="speed-value">65</span>%</label>
                    <input type="range" id="speed-control" min="50" max="100" value="65" oninput="updateSpeedDisplay()">
                    <p class="speed-note">‚ö†Ô∏è Mayor velocidad = Mayor consumo de combustible</p>
                </div>
                <div class="fuel-info">
                    <label>Combustible:</label>
                    <meter id="fuel-meter" min="0" max="1000" value="1000"></meter>
                    <span id="fuel-amount">1000/1000</span>
                </div>
            </div>
        </div>

        <!-- Popup: Lista de Tripulaci√≥n -->
        <div id="crews-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crews">
                <span class="title">Gesti√≥n de Tripulaci√≥n</span>
                <button class="close-btn" onclick="closeCrewsPopup()">√ó</button>
            </div>
            <div class="window-content">
                <h3>Tripulaci√≥n de la Odiseum</h3>
                <table class="crew-table">
                    <thead>
                        <tr>
                            <th>Estado</th>
                            <th>Nombre</th>
                            <th>Posici√≥n</th>
                            <th>Edad</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="crew-list">
                        <!-- Se genera din√°micamente con JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Popup: Gesti√≥n Individual de Tripulante -->
        <div id="crew-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crew">
                <span class="title">Gesti√≥n de Tripulante</span>
                <button class="close-btn" onclick="closeCrewManagementPopup()">√ó</button>
            </div>
            <div class="window-content">
                <div class="crew-header">
                    <img id="crew-img" src="" alt="Tripulante" class="crew-avatar">
                    <div class="crew-info">
                        <h3 id="crew-name">---</h3>
                        <p>Edad: <span id="crew-age">--</span> a√±os</p>
                        <p>Edad Biol√≥gica: <span id="crew-bio-age">--</span> a√±os</p>
                        <p>Posici√≥n: <span id="crew-position">---</span></p>
                        <p>Estado: <span id="crew-state">---</span></p>
                        <p>Actividad: <span id="crew-activity">---</span></p>
                        <p>√Ånimo: <span id="crew-mood">---</span></p>
                        <p class="crew-benefit-line">Beneficio activo: <span id="crew-benefit-readout">Beneficio inactivo (encapsulado).</span></p>
                    </div>
                </div>

                <!-- Sistema de Tabs -->
                <div class="crew-tabs">
                    <button class="crew-tab-btn active" onclick="switchCrewTab('needs')">Necesidades Vitales</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('personal')">Informaci√≥n Personal</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('report')">Reporte</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('story')">Historia IA</button>
                </div>

                <!-- Tab: Necesidades Vitales -->
                <div id="crew-tab-needs" class="crew-tab-content active">
                    <div class="crew-needs">
                        <h4>Necesidades Vitales</h4>
                        <table class="needs-table" id="needs-list">
                            <tr>
                                <td>üçï Alimentaci√≥n</td>
                                <td><span id="food-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageFoodNeed()">Alimentar</button></td>
                            </tr>
                            <tr>
                                <td>‚ù§Ô∏è Salud</td>
                                <td><span id="health-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageHealthNeed()">Curar</button></td>
                            </tr>
                            <tr>
                                <td>üöΩ Higiene</td>
                                <td><span id="waste-need-amount">0</span>%</td>
                                <td><button class="manage-btn" onclick="manageWasteNeed()">Limpiar</button></td>
                            </tr>
                            <tr>
                                <td>üéÆ Entretenimiento</td>
                                <td><span id="entertainment-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageEntertainmentNeed()">Entretener</button></td>
                            </tr>
                            <tr>
                                <td>üò¥ Descanso</td>
                                <td><span id="rest-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageRestNeed()">Descansar</button></td>
                            </tr>
                        </table>
                    </div>
                    <div class="crew-actions">
                        <button id="wake-sleep-btn" onclick="updateWakeSleepFromPopup()">Cambiar Estado</button>
                    </div>
                </div>

                <!-- Tab: Informaci√≥n Personal -->
                <div id="crew-tab-personal" class="crew-tab-content">
                    <div class="crew-personal-info" id="crew-personal-info">
                        <!-- Se llena din√°micamente con JS -->
                    </div>
                </div>

                <!-- Tab: Reporte Personal -->
                <div id="crew-tab-report" class="crew-tab-content">
                    <div class="crew-personal-log">
                        <h4>üìù Reporte Personal</h4>
                        <div id="crew-personal-log-content" class="personal-log-content">
                            <!-- Se llenar√° con JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Historia IA -->
                <div id="crew-tab-story" class="crew-tab-content">
                    <div class="crew-ai-story">
                        <h4>üìñ Historia del Personaje</h4>
                        <div id="crew-ai-story-content" class="ai-story-content">
                            <p style="color: #999; font-style: italic;">Cargando historia...</p>
                        </div>
                        <button class="action-btn" onclick="generateCrewStory()">Generar Historia con IA</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup: Bit√°cora del Comandante -->
        <div id="logbook-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-logbook">
                <span class="title">üìñ Bit√°cora de Odiseum</span>
                <button class="close-btn" onclick="closeLogbookPopup()">√ó</button>
            </div>
            <div class="window-content">
                <div class="logbook-header">
                    <h3>Registro de Misi√≥n</h3>
                    <p class="mission-objective">Objetivo: Transportar cargamento vital a Nueva Tierra</p>
                </div>
                <div class="logbook-entries" id="logbook-entries">
                    <!-- Se genera din√°micamente con JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files (in order) -->
    <script src="scripts/icon-loader.js"></script>
    <script src="scripts/8-icon-replacer.js"></script>
    <script src="scripts/0-config.js"></script>
    <script src="scripts/1-models.js"></script>
    <script src="scripts/2-systems.js"></script>
    <script src="scripts/3-ui-managers.js"></script>
    <script src="scripts/4-crew-data.js"></script>
    <script src="scripts/5-messages-data.js"></script>
    <script src="scripts/7-events-data.js"></script>
    <script src="scripts/6-main.js"></script>
</body>
</html>
