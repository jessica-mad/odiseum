<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odiseum V2.0 - Refactorizado</title>
    
    <!-- CSS Files (in order) -->
    <link rel="stylesheet" href="styles/1-variables.css">
    <link rel="stylesheet" href="styles/2-base.css">
    <link rel="stylesheet" href="styles/3-layout.css">
    <link rel="stylesheet" href="styles/4-components.css">
    <link rel="stylesheet" href="styles/5-theme-retro.css">
</head>
<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;" id="pixelarticons-sprite">
        <symbol id="icon-energy" viewBox="0 0 16 16">
            <path d="M6 1h4v4h3L6 15v-4H3z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-food" viewBox="0 0 16 16">
            <path d="M2 2h2v12H2zM6 2h2v12H6zM10 2h1v5h1V2h1v5h1V2h1v12h-2v-5h-1v5h-1v-5h-1v5h-1z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-water" viewBox="0 0 16 16">
            <path d="M8 1l4 6v3a4 4 0 11-8 0V7z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-oxygen" viewBox="0 0 16 16">
            <path d="M3 5h10v2H3zM1 8h14v2H1zM4 11h8v2H4z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-medicine" viewBox="0 0 16 16">
            <path d="M6 1h4v4h4v4h-4v4H6v-4H2V5h4z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-data" viewBox="0 0 16 16">
            <path d="M2 3h12v2H2zM2 7h12v2H2zM2 11h12v2H2z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-fuel" viewBox="0 0 16 16">
            <path d="M5 1h6v14H5zM11 4h2l2 3v6h-2V8h-2z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-crate" viewBox="0 0 16 16">
            <path d="M2 2h12v12H2zM4 4v8h8V4zM4 7h8v2H4z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-crew" viewBox="0 0 16 16">
            <path d="M5 4a3 3 0 116 0 3 3 0 11-6 0zm-3 9a5 5 0 0110 0v2H2zM10 10h2l4 2v3h-2v-2l-2-1z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-rocket" viewBox="0 0 16 16">
            <path d="M8 0l3 4v6l-3 6-3-6V4zM5 5H1l3 3H5zm6 0h4l-3 3h-1zM7 6h2v2H7z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-logbook" viewBox="0 0 16 16">
            <path d="M3 1h9l2 2v12H3zM5 3v10h7V4H9V1zM2 3h2v10H2z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-earth-old" viewBox="0 0 16 16">
            <path d="M8 1a7 7 0 110 14A7 7 0 018 1zm-1 2H5l-2 3 2 1v2l2 1 1-1V6zM9 3l2 1-1 2 2 1-1 4h-2l-1-2V5z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-earth-new" viewBox="0 0 16 16">
            <path d="M8 1a7 7 0 110 14A7 7 0 018 1zm3 2H7l-1 3 1 2 1 1 1 3h2l1-3-1-2h2l1-1zM4 5H3l-1 2 1 3 2 1V6z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-ship" viewBox="0 0 16 16">
            <path d="M7 1h2l3 5v4l-3 5H7l-3-5V6zM4 6H1v2h3zm11 0h-3v2h3z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
        <symbol id="icon-warning" viewBox="0 0 16 16">
            <path d="M1 14h14L8 2zM7 6h2v4H7zm0 5h2v2H7z" fill="currentColor" shape-rendering="crispEdges" />
        </symbol>
    </svg>
    <!-- Pantalla de Inicio / Login -->
    <div id="initial-screen" class="initial-screen">
        <div class="login-box">
            <h1>ODISEUM V2.0</h1>
            <p>Sistema de Inteligencia Artificial</p>
            <div class="login-form">
                <label for="player-name-input">Identificaci贸n de IA:</label>
                <input type="text" id="player-name-input" placeholder="Ingrese su nombre">
                <button onclick="namePlayer()">Ese es mi nombre</button>
            </div>
        </div>
    </div>

    <!-- Introducci贸n Proyecto G茅nesis -->
    <div id="intro-overlay" class="intro-overlay" style="display: none;">
        <div class="intro-window">
            <div class="logbook-intro">
                <h2>PROYECTO GNESIS</h2>
                <pre id="intro-text-content"></pre>
                <button class="intro-mission-btn" onclick="startMissionFromIntro()">INICIAR MISIN</button>
            </div>
        </div>
    </div>

    <!-- Escritorio Principal -->
    <div id="desktop" class="desktop" style="display: none;">
        <!-- Barra de T铆tulo Principal -->
        <div class="title-bar-main">
            <span class="title-text">Odiseum V2.0</span>
            <span class="player-name-display">IA: <span id="playerName">---</span></span>
        </div>

        <!-- Barra de Detalles / Men煤 -->
        <div class="details-bar">
            <div class="menu-section">
                <button class="menu-btn">Configuraci贸n</button>
                <button class="menu-btn">Instrucciones</button>
            </div>
            <div class="controls-section">
                <button id="start-button" class="control-btn" onclick="startGame()">Comenzar</button>
                <button id="pause-button" class="control-btn" onclick="pauseGame()" style="display: none;">Pausar</button>
                <button id="resume-button" class="control-btn" onclick="resumeGame()" style="display: none;">Reanudar</button>
                <div class="voyage-status" id="voyage-status" style="display: none;"></div>
                <div class="tranche-timer" id="tranche-timer">01:00</div>
                <div class="calendar" id="calendar">A帽o 0</div>
            </div>
        </div>

        <!-- Barra de Recursos Permanente -->
        <div class="resource-strip" id="resource-strip">
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-energy"></use>
                </svg>
                <span class="resource-label">Energ铆a</span>
                <span class="resource-value" id="resource-strip-energy">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-food"></use>
                </svg>
                <span class="resource-label">Alimentos</span>
                <span class="resource-value" id="resource-strip-food">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-water"></use>
                </svg>
                <span class="resource-label">Agua</span>
                <span class="resource-value" id="resource-strip-water">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-oxygen"></use>
                </svg>
                <span class="resource-label">Ox铆geno</span>
                <span class="resource-value" id="resource-strip-oxygen">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-medicine"></use>
                </svg>
                <span class="resource-label">Medicinas</span>
                <span class="resource-value" id="resource-strip-medicine">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-data"></use>
                </svg>
                <span class="resource-label">Datos</span>
                <span class="resource-value" id="resource-strip-data">0/0</span>
            </div>
            <div class="resource-chip">
                <svg class="resource-icon pixel-icon" aria-hidden="true">
                    <use href="#icon-fuel"></use>
                </svg>
                <span class="resource-label">Combustible</span>
                <span class="resource-value" id="resource-strip-fuel">0/0</span>
            </div>
        </div>

        <!-- rea Principal del Escritorio -->
        <div class="desktop-main-area">
            <!-- Iconos del Escritorio -->
            <div class="desktop-icons">
                <div class="desktop-icon" id="icon-resources-management" ondblclick="openResourcesPopup()">
                    <div class="icon-image">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-crate"></use>
                        </svg>
                    </div>
                    <div class="icon-label">Recursos</div>
                </div>
                <div class="desktop-icon" id="icon-crews-management" ondblclick="openCrewsPopup()">
                    <div class="icon-image">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-crew"></use>
                        </svg>
                    </div>
                    <div class="icon-label">Tripulaci贸n</div>
                </div>
                <div class="desktop-icon" id="icon-trip-management" ondblclick="openTripPopup()">
                    <div class="icon-image">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-rocket"></use>
                        </svg>
                    </div>
                    <div class="icon-label">Viaje</div>
                </div>
                <div class="desktop-icon" id="icon-logbook" ondblclick="openLogbookPopup()">
                    <div class="icon-image">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-logbook"></use>
                        </svg>
                    </div>
                    <div class="icon-label">Bit谩cora</div>
                </div>
            </div>

            <!-- Panel de Notificaciones -->
            <div id="notifications" class="notifications-panel"></div>
        </div>

        <div class="voyage-console" id="voyage-visualizer">
            <div class="voyage-console-header">CONSOLA DE NAVEGACIN</div>
            <div class="voyage-panels">
                <div class="voyage-endpoint">
                    <div class="planet-icon old-earth">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-earth-old"></use>
                        </svg>
                    </div>
                    <span class="planet-label">Tierra Vieja</span>
                </div>
                <div class="voyage-track">
                    <div class="voyage-track-line">
                        <div class="voyage-future-line"></div>
                        <div class="voyage-progress-fill" id="voyage-progress-fill"></div>
                        <div class="voyage-ship" id="voyage-ship">
                            <svg class="pixel-icon" aria-hidden="true">
                                <use href="#icon-ship"></use>
                            </svg>
                        </div>
                        <div class="voyage-nodes" id="voyage-node-container"></div>
                    </div>
                </div>
                <div class="voyage-endpoint">
                    <div class="planet-icon new-earth">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-earth-new"></use>
                        </svg>
                    </div>
                    <span class="planet-label">Nueva Tierra</span>
                </div>
            </div>
            <div class="voyage-readouts">
                <div class="voyage-speed">Velocidad actual: <span id="voyage-speed-value">0%</span></div>
                <div class="voyage-distance">Distancia: <span id="voyage-distance-current">0</span> / <span id="voyage-distance-total">0</span> UA</div>
                <div class="voyage-forecast inactive" id="voyage-forecast">Activa a Lt. Johnson para obtener proyecci贸n de tramos.</div>
            </div>
        </div>

        <!-- Panel Lateral de Tripulaci贸n (SIEMPRE VISIBLE) -->
        <div class="crew-sidebar" id="crew-sidebar">
            <div class="sidebar-header">
                <h3>
                    <svg class="pixel-icon" aria-hidden="true">
                        <use href="#icon-rocket"></use>
                    </svg>
                    TRIPULACIN
                </h3>
            </div>
            <div class="sidebar-sorting">
                <label for="crew-sort-select">Ordenar por:</label>
                <select id="crew-sort-select" onchange="onSortChange()">
                    <!-- Se genera din谩micamente con JS -->
                </select>
            </div>
            <div class="sidebar-content" id="crew-cards-container">
                <!-- Se genera din谩micamente con JS -->
            </div>
        </div>

        <!-- Popup: Gesti贸n de Recursos -->
        <div id="resources-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-resources">
                <span class="title">Gesti贸n de Recursos</span>
                <button class="close-btn" onclick="closeResourcesPopup()"></button>
            </div>
            <div class="window-content">
                <h3>Reservas de la Nave</h3>
                <div class="resource-item">
                    <label>Energ铆a:</label>
                    <meter id="energy-meter" min="0" max="1000" value="1000"></meter>
                    <span id="energy-amount">1000/1000</span>
                </div>
                <div class="resource-item">
                    <label>Alimentos:</label>
                    <meter id="food-meter" min="0" max="500" value="500"></meter>
                    <span id="food-amount">500/500</span>
                </div>
                <div class="resource-item">
                    <label>Agua:</label>
                    <meter id="water-meter" min="0" max="300" value="300"></meter>
                    <span id="water-amount">300/300</span>
                </div>
                <div class="resource-item">
                    <label>Ox铆geno:</label>
                    <meter id="oxygen-meter" min="0" max="400" value="400"></meter>
                    <span id="oxygen-amount">400/400</span>
                </div>
                <div class="resource-item">
                    <label>Medicinas:</label>
                    <meter id="medicine-meter" min="0" max="200" value="200"></meter>
                    <span id="medicine-amount">200/200</span>
                </div>
                <div class="resource-item">
                    <label>Datos/Entret.:</label>
                    <meter id="data-meter" min="0" max="150" value="150"></meter>
                    <span id="data-amount">150/150</span>
                </div>
            </div>
        </div>

        <!-- Popup: Gesti贸n del Viaje -->
        <div id="trip-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-trip">
                <span class="title">Gesti贸n del Viaje</span>
                <button class="close-btn" onclick="closeTripPopup()"></button>
            </div>
            <div class="window-content">
                <h3>Progreso del Viaje</h3>
                <div class="trip-info">
                    <label>Destino: Nueva Tierra (Kepler-442b)</label>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="trip-progress-bar"></div>
                    </div>
                    <p>Distancia: <span id="distance-traveled">0</span> / <span id="total-distance">3000</span> UA</p>
                </div>
                <div class="trip-controls">
                    <h4>Control de Velocidad</h4>
                    <label>Velocidad: <span id="speed-value">65</span>%</label>
                    <input type="range" id="speed-control" min="50" max="100" value="65" oninput="updateSpeedDisplay()">
                    <p class="speed-note">
                        <svg class="pixel-icon" aria-hidden="true">
                            <use href="#icon-warning"></use>
                        </svg>
                        Mayor velocidad = Mayor consumo de combustible
                    </p>
                </div>
                <div class="fuel-info">
                    <label>Combustible:</label>
                    <meter id="fuel-meter" min="0" max="1000" value="1000"></meter>
                    <span id="fuel-amount">1000/1000</span>
                </div>
            </div>
        </div>

        <!-- Popup: Lista de Tripulaci贸n -->
        <div id="crews-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crews">
                <span class="title">Gesti贸n de Tripulaci贸n</span>
                <button class="close-btn" onclick="closeCrewsPopup()"></button>
            </div>
            <div class="window-content">
                <h3>Tripulaci贸n de la Odiseum</h3>
                <table class="crew-table">
                    <thead>
                        <tr>
                            <th>Estado</th>
                            <th>Nombre</th>
                            <th>Posici贸n</th>
                            <th>Edad</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="crew-list">
                        <!-- Se genera din谩micamente con JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Popup: Gesti贸n Individual de Tripulante -->
        <div id="crew-management-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-crew">
                <span class="title">Gesti贸n de Tripulante</span>
                <button class="close-btn" onclick="closeCrewManagementPopup()"></button>
            </div>
            <div class="window-content">
                <div class="crew-header">
                    <img id="crew-img" src="" alt="Tripulante" class="crew-avatar">
                    <div class="crew-info">
                        <h3 id="crew-name">---</h3>
                        <p>Edad: <span id="crew-age">--</span> a帽os</p>
                        <p>Edad Biol贸gica: <span id="crew-bio-age">--</span> a帽os</p>
                        <p>Posici贸n: <span id="crew-position">---</span></p>
                        <p>Estado: <span id="crew-state">---</span></p>
                        <p>Actividad: <span id="crew-activity">---</span></p>
                        <p>nimo: <span id="crew-mood">---</span></p>
                        <p class="crew-benefit-line">Beneficio activo: <span id="crew-benefit-readout">Beneficio inactivo (encapsulado).</span></p>
                    </div>
                </div>

                <!-- Sistema de Tabs -->
                <div class="crew-tabs">
                    <button class="crew-tab-btn active" onclick="switchCrewTab('needs')">Necesidades Vitales</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('personal')">Informaci贸n Personal</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('report')">Reporte</button>
                    <button class="crew-tab-btn" onclick="switchCrewTab('story')">Historia IA</button>
                </div>

                <!-- Tab: Necesidades Vitales -->
                <div id="crew-tab-needs" class="crew-tab-content active">
                    <div class="crew-needs">
                        <h4>Necesidades Vitales</h4>
                        <table class="needs-table" id="needs-list">
                            <tr>
                                <td> Alimentaci贸n</td>
                                <td><span id="food-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageFoodNeed()">Alimentar</button></td>
                            </tr>
                            <tr>
                                <td>わ Salud</td>
                                <td><span id="health-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageHealthNeed()">Curar</button></td>
                            </tr>
                            <tr>
                                <td> Higiene</td>
                                <td><span id="waste-need-amount">0</span>%</td>
                                <td><button class="manage-btn" onclick="manageWasteNeed()">Limpiar</button></td>
                            </tr>
                            <tr>
                                <td> Entretenimiento</td>
                                <td><span id="entertainment-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageEntertainmentNeed()">Entretener</button></td>
                            </tr>
                            <tr>
                                <td> Descanso</td>
                                <td><span id="rest-need-amount">100</span>%</td>
                                <td><button class="manage-btn" onclick="manageRestNeed()">Descansar</button></td>
                            </tr>
                        </table>
                    </div>
                    <div class="crew-actions">
                        <button id="wake-sleep-btn" onclick="updateWakeSleepFromPopup()">Cambiar Estado</button>
                    </div>
                </div>

                <!-- Tab: Informaci贸n Personal -->
                <div id="crew-tab-personal" class="crew-tab-content">
                    <div class="crew-personal-info" id="crew-personal-info">
                        <!-- Se llena din谩micamente con JS -->
                    </div>
                </div>

                <!-- Tab: Reporte Personal -->
                <div id="crew-tab-report" class="crew-tab-content">
                    <div class="crew-personal-log">
                        <h4> Reporte Personal</h4>
                        <div id="crew-personal-log-content" class="personal-log-content">
                            <!-- Se llenar谩 con JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Historia IA -->
                <div id="crew-tab-story" class="crew-tab-content">
                    <div class="crew-ai-story">
                        <h4> Historia del Personaje</h4>
                        <div id="crew-ai-story-content" class="ai-story-content">
                            <p style="color: #999; font-style: italic;">Cargando historia...</p>
                        </div>
                        <button class="action-btn" onclick="generateCrewStory()">Generar Historia con IA</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup: Bit谩cora del Comandante -->
        <div id="logbook-popup" class="window interface" style="display: none;">
            <div class="title-bar" id="title-bar-logbook">
                <span class="title"> Bit谩cora de Odiseum</span>
                <button class="close-btn" onclick="closeLogbookPopup()"></button>
            </div>
            <div class="window-content">
                <div class="logbook-header">
                    <h3>Registro de Misi贸n</h3>
                    <p class="mission-objective">Objetivo: Transportar cargamento vital a Nueva Tierra</p>
                </div>
                <div class="logbook-entries" id="logbook-entries">
                    <!-- Se genera din谩micamente con JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files (in order) -->
    <script src="scripts/0-config.js"></script>
    <script src="scripts/1-models.js"></script>
    <script src="scripts/2-systems.js"></script>
    <script src="scripts/3-ui-managers.js"></script>
    <script src="scripts/4-crew-data.js"></script>
    <script src="scripts/5-messages-data.js"></script>
    <script src="scripts/7-events-data.js"></script>
    <script src="scripts/6-main.js"></script>
</body>
</html>
